# Graduate-Recommendation-Evaluation

## 📝 OVERVIEW

 推免管理系统项目的后端代码

### 💡 规则指标

不同学院/类别的成绩规则不同。 
由学院管理员录入，成绩规则由若干层级的指标点组成，类似树的结构，每个指标点包含不同评分规则。

规则指标点的类型可以分为

 - 一级指标(根节点)。第一级的指标分类。例如:学术专长、文体特长、其它方面。
 - 过程指标。连接第一级到最后一级指标的中间节点。例如：学科竞赛、高质量论文。
 - 叶子指标。最后一级的叶子指标节点，只有最后一级导师可评分。例如：第一等级、科技竞赛1。

如：
  1. 学术专长-学科竞赛-第一等级
  2. 学术专长-高质量论文-顶级期刊
  3. 学术专长-其它学术专长-科技竞赛1 

### 🆔 角色功能

#### 超级管理员

+ 学院的增删改查
+ 添加学院管理员

#### 学院管理员

+ 类别的增删改查 
+ 专业的增删改查 
+ 添加导师 
+ 给指定导师分配类别
+ 添加规则指标节点

#### 导师

#### 学生

+ 注册

<hr/>
<br/>

### ✅ update
<br/>

<br/>
2025-9-27
<br/>
<br/>

逻辑判断都放在Service 层，而且没有抽象出可复用的方法
+ 导致**Service 层过于冗余**，职责过重

> 可以复用的逻辑判断等代码抽象成方法，部分代码放在Controller 层

<hr>

保存学院管理员与类别关系，学院管理员的token中保存了List< Long >类别ID

+ 学院管理员新建类别后，没有对该类别的权限，因为权限根据token判断，而token只有重新登录后才更新，不会自动刷新

所以学院管理员的token中只保存学院college ID，对类别的操作权限根据college ID判断。

> 用户类别关系表改为**导师类别关系表**， token 逻辑更改

<hr>

导师：
> 1. 查看自己管理的类别

学院管理员：
> 1. 添加规则指标节点

<br/>
2025-9-26
<br/>
<br/>

**编写http脚本测试**

四个角色用户的登录

超级管理员：
> 1. 学院的增删改查
> 2. 添加学院管理员

学院管理员：
> 1. 类别的增删改查
> 2. 专业的增删改查
> 3. 添加导师
> 4. 给指定导师分配类别

学生：
> 注册

config:
+ WebMvcConfig: LoginInterceptor、四个角色的Interceptor
+ JacksonConfig

<br/>
2025-9-25
<br/>
<br/>

+ 添加DO类
+ 添加Repository
+ InitService初始化超级管理员
+ 封装ResultVO
+ 封装Code以及自定义异常XException
+ ExceptionController

雪花算法返回String类型修改为Long类型

<br/>
2025-9-24
<br/>
<br/>

**完善sql脚本测试**
 + 使用 with recursive 递归 cte 查询指定节点及其所有后代节点

student：
> 1. 学生查找一级指标点下的所有信息
> 2. 学生对于指定指标点上传佐证拼接路径(文件名)
> 3. 学生新增提交项(record初始化为json数组)
> 4. 学生查询个人的成绩统计信息

teacher：
> 1. 导师获取自己管理的类别
> 2. 导师获取指定类别下全部专业
> 3. 导师获取某专业下的所有学生的信息包括提交项
> 4. 导师审批
> 5. 导师查询专业下所有学生的成绩统计信息

collegeAdmin:
> 1. 学院管理员查看某类别下的所有学生信息
> 2. 学院管理员添加推免规则节点

<br/>
2025-9-23
<br/>
<br/>

1. 编写导师以及学院管理员sql测试脚本
2. 用户表添加类别id
3. 指标提交表中json数组形式的file字段舍去，改为创建
 > 提交文件表-submit_file

<br/>
2025-9-22
<br/>
<br/>

1. 编写指标节点和学生sql测试脚本
2. 指标提交表添加根节点id字段
3. 给file字段添加default '[ ]' 发现mysql不支持给json属性添加默认值，只能手动初始化file字段为json数组


<br/>
2025-9-21
<br/>
<br/>

尝试建立数据库，创建
 > 用户表-user
 > 
 > 学院表-college
 > 
 > 类别表-category
 > 
 > 专业表-major
 > 
 > 用户-类别关系表-user_category
 > 
 > 成绩表-score
 > 
 > 指标节点表-target_node
 >
 > 指标提交表-target_submit